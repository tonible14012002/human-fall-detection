/*! citationexporter 12-02-2021 */

jQuery(function($){var metastr=jQuery('meta[name="citationexporter"]').attr("content"),metaopts={};if(metastr)try{metaopts=eval("({"+metastr+"})")}catch(e){}function citationexporter(r,i,e){var n,c=this;function t(){if(r.fn.ncbipopper){var t,o,e={destText:s,groupName:"citationexporter"};(n=i).ncbipopper(r.extend({},c.options,e)),t=n.data("ncbipopper"),o=t.close,t.close=function(e){return t.isFunctionResultCached=!1,t.getTextCalled=!1,t.callbackInProgress=!1,o.call(t,e)}}}function a(){jQuery(window).trigger("ncbipopperdocumentresize")}function s(n){i.on("citationexporterrendered",function(e,t,o){n(t.content),a()}).on("citationexporterfailed",function(e,t){n("Sorry! An error occurred while rendering the citation. Please try again later."),a()}),c.render.call(c)}function p(e){return void 0!==e.replace?e.replace(/[^0-9]+/,""):e}function o(e,t){var o={format:e,id:p(c.ids),download:!0};return'<a class="citationexporter '+e+'" href="'+c.options.backend+"?"+r.param(o)+'">'+t+"</a>"}function d(e,t,o){i.trigger("citationexporter"+e,[o])}return c.options={ids:null,backend:"//api.ncbi.nlm.nih.gov/lit/ctxp/v1/pmc/",styles:["ama","mla","apa","nlm"],header:"Copy and paste a formatted citation from below or use one of the hyperlinks at the bottom to download a file for import into a bibliography manager.",footer:"Download as: ",addCloseButton:!0,destPosition:"center auto",triggerPosition:"center auto",openEvent:"click",closeEvent:"click",hasArrow:!0,isDestElementCloseClick:!1,isDestTextCacheable:!0,adjustFit:"autoAdjust",requestTimeout:0,cssClass:"ctxp-popper",openAnimation:"none"},c.open=function(e){c.ids=e,n||t(),n.ncbipopper("open")},c.close=function(){n&&n.ncbipopper("close")},c.render=function(e){var t;e&&(c.ids=e),t={format:"citation",id:p(c.ids)},r.ajax({url:c.options.backend,type:"GET",crossDomain:!0,data:t,dataType:"json",timeout:c.options.requestTimeout,success:function(e){d("rendered",null,{content:function(i){var e=r("<div/>");r('<div class="ctxp-header"/>').html(c.options.header).appendTo(e);var a=r('<table class="ctxp-body"/>');return r.each(c.options.styles,function(e,t){var o,n;void 0!==i[t]&&void 0!==i[t].format&&a.append((o=t.toUpperCase(),n=i[t].format,r("<tr/>").html("<th>"+o+"</th><td>"+n+"</td>").click(function(e){var t=r(this).find("td").get(0);if(document.selection){var o=document.body.createTextRange();o.moveToElementText(t),o.select()}else if(window.getSelection()){var o=document.createRange();o.selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(o)}})))}),a.appendTo(e),r('<div class="ctxp-footer"/>').html(c.options.footer+o("ris","RIS")+o("medline","NBIB")+o("csl","JSON")).appendTo(e),e}(e)})},error:function(e,t){d("failed",null,e)}})},c.setOptions=function(e){r.extend(c.options,e)},r.extend(c.options,e,metaopts,i.data()),c.ids=i.data("citationid"),t(),c}$.fn.extend({citationexporter:function(t,o){return this.each(function(){var e=$(this).data("citationexporter-instance");if(e||(e=new citationexporter(jQuery,$(this),t),$(this).data("citationexporter-instance",e)),"string"==typeof t)switch(t){case"open":e.open(o);break;case"close":e.close();break;case"render":e.render(o);break;case"options":e.setOptions(o)}})}}),$("a.citationexporter").citationexporter(),$("a.citationexporter.hidden").removeClass("hidden")});